{"ast":null,"code":"export default {\n  name: \"PeopleManage\",\n  components: {},\n  mounted: function () {\n    this.queryPeople();\n    //查询cname搜索框\n    this.$http.get(\"people\").then(response => {\n      for (let i = 0; i < response.data.length; i++) {\n        response.data[i].value = response.data[i].name;\n        // this.autoCityNameSearch[i].value = response.data[i].cname\n      }\n\n      this.autoPeopleNameSearch = response.data;\n      // console.log(this.autoCityNameSearch)\n    }).catch(function (error) {\n      console.log(error);\n    });\n  },\n  data() {\n    return {\n      tableData: [],\n      currentPage: 1,\n      //当前的\n      count: 0,\n      //分页查询页面总数\n      pageNum: 1,\n      //\n      pageSize: 100,\n      //默认的分页大小\n      PeopleNameSearch: \"\",\n      autoPeopleNameSearch: [],\n      addVisible: false,\n      //添加的显示框\n      updateVisible: false,\n      //更新的显示框\n      form: {\n        name: '',\n        // 城市名\n        birthDate: '',\n        //经度\n        deathDate: '',\n        //纬度\n        introduction: '',\n        //省份   \n        pictureP: '' //图片目录\n      },\n\n      multipleSelection: [],\n      dialogImageUrl: '',\n      dialogVisible: false\n    };\n  },\n  methods: {\n    //将分页查询的axios分装在方法中\n    queryPeople() {\n      this.$http.get(\"queryPeoplePage\", {\n        params: {\n          pageNum: this.pageNum,\n          pageSize: this.pageSize,\n          name: this.PeopleNameSearch\n        }\n      }).then(response => {\n        this.tableData = response.data.data;\n        this.count = response.data.count;\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    // 重置两个搜索框\n    refreshInput() {\n      this.PeopleNameSearch = \"\";\n      this.queryPeople();\n    },\n    //监听操作按钮\n    handleEdit(index, row) {\n      this.updateVisible = true;\n      this.form = row;\n      // console.log(index, row);\n    },\n\n    //删除操作\n    //单个删除\n    handleDelete(index, row) {\n      // console.log(row.id);\n      this.$confirm('此操作将永久删除该条信息, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$http.delete(\"/People/\" + row.id).then(res => {\n          if (res) {\n            this.$message({\n              type: 'success',\n              message: '删除成功!'\n            });\n            this.queryPeople();\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    //批量删除\n    handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    deleteMultiplePeople() {\n      let ids = this.multipleSelection.map(v => v.id);\n      this.$confirm('此操作将永久删除该条信息, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$http.post(\"/People/batch\", ids).then(res => {\n          if (res) {\n            this.$message({\n              type: 'success',\n              message: '删除成功!'\n            });\n            this.queryPeople();\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    //监听pageNum\n    handleCurrentChange(pageNum) {\n      // console.log(pageNum);\n      this.pageNum = pageNum;\n      this.queryPeople();\n    },\n    //监听pageSize的\n    handleSizeChange(pageSize) {\n      // console.log(pageSize);\n      this.pageSize = pageSize;\n      this.queryPeople();\n    },\n    // 监听PeopleNameSearch\n    PeopleSearch() {\n      this.queryPeople();\n    },\n    //两个el-autocomplete的选择\n    handleSelect1(item) {\n      console.log(item.value);\n    },\n    querySearch1(queryString, cb) {\n      var results = queryString ? this.autoPeopleNameSearch.filter(this.createFilter(queryString)) : this.autoPeopleNameSearch;\n      cb(results);\n    },\n    createFilter(queryString) {\n      return item => {\n        return item.value.toUpperCase().match(queryString.toUpperCase());\n      };\n    },\n    //添加窗体的操作\n    //清空\n    clearInput() {\n      this.form.name = '';\n      this.form.birthDate = '';\n      this.form.deathDate = '';\n      this.form.introduction = '';\n    },\n    //添加和更新城市的函数\n    savePeople(form) {\n      this.$http.post(\"savePeople\", form).then(res => {\n        if (res) {\n          this.$message.success('保存成功');\n          this.addVisible = false;\n          this.updateVisible = false;\n        } else {\n          this.$message.error(\"保存失败\");\n        }\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    //添加城市信息\n    addPeople() {\n      this.savePeople(this.form);\n      this.queryPeople();\n    },\n    //更新城市信息\n    updatePeople() {\n      this.savePeople(this.form);\n      this.queryPeople();\n    },\n    clearForm() {\n      this.form.id = Number;\n      this.form.name = '';\n      this.form.birthDate = '';\n      this.form.deathDate = '';\n      this.form.introduction = '';\n      this.form.pictureP = '';\n    },\n    reset() {\n      this.clearForm();\n      this.queryPeople();\n    },\n    handle_success(res) {\n      console.log(res.data);\n      this.$message.success(\"图片上传成功\");\n      this.form.pictureP = res.data;\n      //   return (this.form.imgUrl = res.data);\n    },\n\n    //删除图片\n    handleRemove(file) {\n      console.log(file);\n    },\n    //放大看图片函数\n    handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n    handleImportSuccess() {\n      this.$message.success(\"导入成功\");\n      this.queryPeople;\n    }\n  }\n};","map":{"version":3,"mappings":"AAsKA;EACAA;EACAC,aACA;EACAC;IACA;IACA;IACA,yBACAC;MACA;QACAC;QACA;MACA;;MACA;MACA;IACA,GACAC;MACAC;IACA;EAEA;EAEAC;IACA;MACAC;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAEAC;MAEAC;MAAA;MACAC;MAAA;MACAC;QACAjB;QAAA;QACAkB;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;MACA;;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;QACAC;UACAhB;UACAC;UACAZ;QACA;MACA,GACAG;QACA;QACA;MAEA,GACAE;QACAC;MACA;IACA;IAEA;IACAsB;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;IACA;;IACA;IACA;IACAC;MACA;MACA;QACAC;QACAC;QACAC;MACA;QACA;UACA;YACA;cACAA;cACAC;YACA;YACA;UACA;QACA;MACA;QACA;UACAD;UACAC;QACA;MACA;IACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;QACAL;QACAC;QACAC;MACA;QACA;UACA;YACA;cACAA;cACAC;YACA;YACA;UACA;QACA;MACA;QACA;UACAD;UACAC;QACA;MACA;IACA;IACA;IACAG;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;MACA;MACA;IACA;IAEA;IACAC;MACA;IACA;IAGA;IACAC;MACAlC;IACA;IACAmC;MACA;MACAC;IACA;IAEAC;MACA;QACA;MACA;IACA;IAEA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC;MACA,oCACA1C;QACA;UACA;UACA;UACA;QACA,OACA;UACA;QACA;MACA,GACAE;QACAC;MACA;IACA;IACA;IACAwC;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA5C;MACA;MACA;MACA;IACA;;IACA;IACA6C;MACA7C;IACA;IACA;IACA8C;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;EAGA;AACA","names":["name","components","mounted","then","response","catch","console","data","tableData","currentPage","count","pageNum","pageSize","PeopleNameSearch","autoPeopleNameSearch","addVisible","updateVisible","form","birthDate","deathDate","introduction","pictureP","multipleSelection","dialogImageUrl","dialogVisible","methods","queryPeople","params","refreshInput","handleEdit","handleDelete","confirmButtonText","cancelButtonText","type","message","handleSelectionChange","deleteMultiplePeople","handleCurrentChange","handleSizeChange","PeopleSearch","handleSelect1","querySearch1","cb","createFilter","clearInput","savePeople","addPeople","updatePeople","clearForm","reset","handle_success","handleRemove","handlePictureCardPreview","handleImportSuccess"],"sourceRoot":"src/view/back/RouterMain/People","sources":["PeopleManage.vue"],"sourcesContent":["<template>\n  <div>\n    <div style=\"margin-bottom:15px\">\n      <el-button type=\"primary\" @click=\"addVisible = true\"><i class=\"el-icon-plus\"></i>新增</el-button>\n      <el-button type=\"primary\" @click=\"deleteMultiplePeople\"><i class=\"el-icon-plus\"></i>批量删除</el-button>\n      <el-button type=\"primary\" @click=\"refreshInput\" style=\"margin-right: 10px;\"><i class=\"el-icon-refresh-right\"></i>重置</el-button>\n      <el-upload\n        class=\"upload-demo\"\n        action=\"http://localhost:8088/People/upload\"\n        :show-file-list=\"false\"\n        accept=\"xlsx\"\n        :on-success=\"handleImportSuccess\"\n        >\n        <el-button size=\"small\" type=\"primary\">导入</el-button>\n      </el-upload>\n\n      诗人搜索： <el-autocomplete @change=\"PeopleSearch\"\n        class=\"inline-input\"\n        v-model=\"PeopleNameSearch\"\n        :fetch-suggestions=\"querySearch1\"\n        placeholder=\"请输入姓名\"\n        @select=\"handleSelect1\"\n        :trigger-on-focus=\"false\"\n      ></el-autocomplete>\n      \n    </div>\n    \n    <!-- 分页查询的表格 -->\n    <el-table :data=\"tableData\"\n      border\n      @selection-change=\"handleSelectionChange\">\n      <el-table-column type=\"selection\"> </el-table-column>\n      <el-table-column prop=\"id\" label=\"id\" align=\"center\" min-width=\"46%\"> </el-table-column>\n      <el-table-column prop=\"name\" label=\"诗人姓名\" align=\"center\"> </el-table-column>\n      <el-table-column prop=\"birthDate\" label=\"出生日期\" align=\"center\"> </el-table-column>\n      <el-table-column prop=\"deathDate\" label=\"死亡日期\" align=\"center\"> </el-table-column>\n      <el-table-column prop=\"introduction\" label=\"诗人介绍\" align=\"center\" :show-overflow-tooltip=\"true\"> </el-table-column>\n      \n      <el-table-column label=\"图片\" align=\"center\"> \n        <template width=\"40\" slot-scope=\"scope\">\n          <el-image \n            v-if=\"scope.row.pictureP != '' && scope.row.pictureP != null\"\n            \n            :src=\"require('@/assets/image/' + scope.row.pictureP)\"\n            style=\"width: 100px; height: 100px\">\n          </el-image>\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\"  label=\"操作\">\n        <template slot-scope=\"scope\">\n          <el-button\n            size=\"mini\"\n            @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\n          <el-button\n            size=\"mini\"\n            type=\"danger\"\n            @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\n        </template>\n    </el-table-column>\n    </el-table>\n\n    <!-- 分页查询的 -->\n    <div class=\"block\" style=\"margin-top:15px\">\n      <el-pagination\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n        :current-page=\"currentPage\"\n        :page-size=\"100\"\n        :page-sizes=\"[2, 5, 8, 100]\"   \n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"count\">\n      </el-pagination>\n    </div>\n\n    <!--添加按钮的代码-->\n    <el-dialog title=\"添加城市信息\" :visible.sync=\"addVisible\" width=\"50%\" @close=\"reset\">\n       <el-form ref=\"form\" :model=\"form\" label-width=\"80px\">\n            <el-form-item label=\"诗人姓名\">\n                <el-input v-model=\"form.name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"出生日期\">\n                <el-input v-model=\"form.birthDate\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"死亡日期\">\n                <el-input v-model=\"form.deathDate\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"诗人简介\">\n                <el-input :rows=\"5\" type=\"textarea\" v-model=\"form.introduction\"></el-input>\n            </el-form-item>\n            <!-- 上传照片 :on-success=\"handle_success\" -->\n            <div style=\"margin-left:80px\">\n                        上传景点图片限一张\n                        <el-upload \n                          action=\"http://localhost:8088/file/upload\"\n                          :on-success=\"handle_success\"\n                          list-type=\"picture-card\"\n                          :on-preview=\"handlePictureCardPreview\"\n                          :on-remove=\"handleRemove\"\n                          :limit=\"1\"\n                          >\n                          <div slot=\"tip\" class=\"el-upload__tip\">\n                              只能上传jpg/png文件，且不超过500kb\n                          </div>\n                          <i class=\"el-icon-plus\"></i>\n                        </el-upload>\n                        <el-dialog :visible.sync=\"dialogVisible\">\n                          <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n                        </el-dialog>\n                      </div>\n                      \n            <el-form-item>\n                <el-button type=\"primary\" @click=\"addPeople\">添加</el-button>\n                <el-button @click=\"clearInput\">重置</el-button>\n            </el-form-item>\n       </el-form>\n    </el-dialog>\n\n    <!--更新的按钮-->\n    <el-dialog title=\"更新城市信息\" :visible.sync=\"updateVisible\" width=\"50%\" @close=\"reset\">\n       <el-form ref=\"form\" :model=\"form\" label-width=\"80px\">\n            <el-form-item label=\"诗人姓名\">\n                <el-input v-model=\"form.name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"出生日期\">\n                <el-input v-model=\"form.birthDate\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"死亡日期\">\n                <el-input v-model=\"form.deathDate\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"诗人简介\">\n                <el-input :rows=\"5\" type=\"textarea\" v-model=\"form.introduction\"></el-input>\n            </el-form-item>\n            <div style=\"margin-left:80px\" >\n                        修改景点图片限一张\n                        <el-upload \n                          action=\"http://localhost:8088/file/upload\"\n                          :on-success=\"handle_success\"\n                          list-type=\"picture-card\"\n                          :on-preview=\"handlePictureCardPreview\"\n                          :on-remove=\"handleRemove\"\n                          :limit=\"1\"\n                          >\n                          <div slot=\"tip\" class=\"el-upload__tip\">\n                              只能上传jpg/png文件，且不超过500kb\n                          </div>\n                          <i class=\"el-icon-plus\"></i>\n                        </el-upload>\n\n                        <el-dialog :visible.sync=\"dialogVisible\">\n                          <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n                        </el-dialog>\n                      </div>\n            \n            <el-form-item>\n                <el-button type=\"primary\" @click=\"updatePeople\">保存</el-button>\n                <!-- <el-button @click=\"clearInput\">重置</el-button> -->\n            </el-form-item>\n       </el-form>\n    </el-dialog>\n\n  </div>\n</template>\n\n<script>\n\nexport default {\n  name: \"PeopleManage\",\n  components:{\n  },\n  mounted:function(){\n    this.queryPeople()\n    //查询cname搜索框\n    this.$http.get(\"people\")\n      .then(response=>{\n        for(let i = 0; i < response.data.length; i++){\n          response.data[i].value = response.data[i].name\n          // this.autoCityNameSearch[i].value = response.data[i].cname\n        }\n        this.autoPeopleNameSearch = response.data\n        // console.log(this.autoCityNameSearch)\n      })\n      .catch(function(error){\n        console.log(error)\n      })\n      \n  },\n  \n  data() {\n    return {\n      tableData : [],\n      currentPage : 1,//当前的\n      count : 0,//分页查询页面总数\n      pageNum : 1,//\n      pageSize : 100,//默认的分页大小\n      PeopleNameSearch : \"\",\n      \n      autoPeopleNameSearch : [],\n      \n      addVisible : false,//添加的显示框\n      updateVisible : false,//更新的显示框\n      form: {\n                name: '', // 城市名\n                birthDate: '', //经度\n                deathDate: '', //纬度\n                introduction: '',//省份   \n                pictureP: ''//图片目录\n            },\n      multipleSelection : [],\n      dialogImageUrl: '',\n      dialogVisible: false,\n    }\n  },\n  methods:{\n    //将分页查询的axios分装在方法中\n    queryPeople(){\n      this.$http.get(\"queryPeoplePage\",{\n      params:{\n        pageNum : this.pageNum,\n        pageSize : this.pageSize,\n        name : this.PeopleNameSearch\n      }\n    })\n    .then(response=>{\n      this.tableData = response.data.data\n      this.count = response.data.count\n      \n    })\n    .catch(function(error){\n      console.log(error)\n    })\n    },\n\n    // 重置两个搜索框\n    refreshInput(){\n      this.PeopleNameSearch = \"\"\n      this.queryPeople()\n    },\n\n    //监听操作按钮\n    handleEdit(index, row) {\n      this.updateVisible = true\n      this.form = row\n      // console.log(index, row);\n    },\n    //删除操作\n    //单个删除\n    handleDelete(index, row) {\n      // console.log(row.id);\n       this.$confirm('此操作将永久删除该条信息, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.$http.delete(\"/People/\" + row.id).then(res=>{\n            if(res){\n              this.$message({\n                type: 'success',\n                message: '删除成功!'\n              })\n              this.queryPeople()\n            }\n          })\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });          \n        });\n    },\n    //批量删除\n    handleSelectionChange(val){\n      this.multipleSelection = val\n    },\n    deleteMultiplePeople(){\n      let ids = this.multipleSelection.map(v => v.id)\n      this.$confirm('此操作将永久删除该条信息, 是否继续?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          this.$http.post(\"/People/batch\",ids).then(res=>{\n            if(res){\n              this.$message({\n                type: 'success',\n                message: '删除成功!'\n              })\n              this.queryPeople()\n            }\n          })\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });          \n        });\n    },\n    //监听pageNum\n     handleCurrentChange(pageNum){\n      // console.log(pageNum);\n      this.pageNum =pageNum\n      this.queryPeople()\n    },\n\n    //监听pageSize的\n    handleSizeChange(pageSize){\n      // console.log(pageSize);\n      this.pageSize = pageSize\n      this.queryPeople()\n    },\n\n    // 监听PeopleNameSearch\n    PeopleSearch(){\n      this.queryPeople()\n    },\n\n\n    //两个el-autocomplete的选择\n    handleSelect1(item) {\n        console.log(item.value);\n    },\n    querySearch1(queryString,cb){\n       var results = queryString ? this.autoPeopleNameSearch.filter(this.createFilter(queryString)) : this.autoPeopleNameSearch;\n       cb(results);\n    },\n\n    createFilter(queryString) {\n      return (item) => {\n        return item.value.toUpperCase().match(queryString.toUpperCase());\n      };\n    },\n\n    //添加窗体的操作\n    //清空\n    clearInput(){\n            this.form.name = ''\n            this.form.birthDate = ''\n            this.form.deathDate = ''\n            this.form.introduction = ''\n        },\n    //添加和更新城市的函数\n    savePeople(form){\n      this.$http.post(\"savePeople\",form)\n            .then(res => {\n                if(res){\n                  this.$message.success('保存成功');\n                  this.addVisible = false\n                  this.updateVisible = false                 \n                }\n                else{\n                  this.$message.error(\"保存失败\")\n                }\n            })\n            .catch(function (error) {\n                console.log(error);\n            })\n    },\n    //添加城市信息\n    addPeople(){\n      this.savePeople(this.form)\n      this.queryPeople()\n    },\n    //更新城市信息\n    updatePeople(){\n      this.savePeople(this.form)\n      this.queryPeople()\n    },\n    clearForm(){\n      this.form.id = Number\n      this.form.name = ''\n      this.form.birthDate = ''\n      this.form.deathDate = ''\n      this.form.introduction = ''\n      this.form.pictureP = ''\n    },\n    reset(){\n      this.clearForm()\n      this.queryPeople()\n    },\n    handle_success(res) {\n        console.log(res.data);\n        this.$message.success(\"图片上传成功\");\n        this.form.pictureP = res.data\n      //   return (this.form.imgUrl = res.data);\n      },\n       //删除图片\n    handleRemove(file) {\n      console.log(file);\n    },\n      //放大看图片函数\n    handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url;\n      this.dialogVisible = true;\n    },\n    handleImportSuccess(){\n      this.$message.success(\"导入成功\")\n      this.queryPeople\n    }\n    \n  \n  }\n};\n</script>\n\n<style>\n.el-pagination{\n  text-align: center;\n}\n.el-autocomplete{\n  width: 120px;\n}\n.upload-demo{\n  display: inline-block;\n  \n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}